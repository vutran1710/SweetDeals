- type: serial
  steps:
    - name: testing
      exclude: master
      service: sweetdeals
      command: npm run verify
    # - name: publish new docker image
    #   tag: master
    #   service: sweetdeals
    #   type: push
    #   image_name: vutrio/sweetdeals-image-demo
    #   image_tag: "{{ .Branch }}"
    #   encrypted_dockercfg_path: dockercfg.encrypted
    - name: deploy app
      tag: master
      service: kubectl
      command: /bin/sh -c "kubectl get all && kubectl rolling-update app-controller --image=vutrio/sweetdeals-image-demo:$CI_BRANCH"
