- type: serial
  steps:
    - name: local_testin
      exclude: master
      service: sweetdeals
      command: npm run verify
    - name: publish_new_image
      tag: master
      service: sweetdeals
      type: push
      image_name: vutrio/sweetdeals-image-demo
      image_tag: "{{ .CommitID }}"
      encrypted_dockercfg_path: dockercfg.encrypted
    - name: deploy_new_app_version
      tag: master
      service: kubectl
      command: kubectl rollout app-controller --image=vutrio/sweetdeals-image-demo:"{{ .CommitID }}"
